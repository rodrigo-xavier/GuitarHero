function [holding_buttons, holding_times] = rastro_detection(galileo, imgO, holding_buttons, holding_times)

    % ------------------------------------------------------------------------- %
    % Configuracao das variaveis (Eles tambÃ©m existem na funcao press_buttons)
    % acoes
    APERTA_SEM_SOLTAR_RED = char(101);
    SOLTA_RED = char(102);
    APERTA_E_SOLTA_GREEN = char(110);
    APERTA_SEM_SOLTAR_GREEN = char(111);
    SOLTA_GREEN = char(112);
    APERTA_E_SOLTA_YELLOW = char(120);
    APERTA_SEM_SOLTAR_YELLOW = char(121);
    SOLTA_YELLOW = char(122);
    APERTA_E_SOLTA_BLUE = char(130);
    APERTA_SEM_SOLTAR_BLUE = char(131);
    SOLTA_BLUE = char(132);
    APERTA_E_SOLTA_ORANGE = char(140);
    APERTA_SEM_SOLTAR_ORANGE = char(141);
    SOLTA_ORANGE = char(142);

    % cores
    R = 1;
    G = 2;
    B = 3;

    % cores
    % TODO: salvar um arquivo em disco com as variaveis
    % para mudar para apenas load('cores.mat')
    red_min = 175;
    red_max = 255;
    green_min = 175;
    green_max = 175;
    yellowR_min = 175;
    yellowR_max = 255;
    yellowG_min = 150;
    yellowG_max = 255;
    blueG_min = 125;
    blueG_max = 255;
    blueB_min = 175;
    blueB_max = 255;
    orangeR_min = 175;
    orangeR_max = 255;
    orangeG_min = 95;
    orangeG_max = 255;

    % ------------------------------------------------------------------------- %

    % Red
    %Segura botao no rastro
    %Se nao esta apertando e passa o rastro pela primeira vez
    if( ~holding_buttons('red') && ...
        (imgO(293,275,R) >= red_min && imgO(293,275,R) <= red_max) && ...
        (imgO(292,275,R) >= red_min && imgO(292,275,R) <= red_max) && ...
        (imgO(291,275,R) >= red_min && imgO(291,275,R) <= red_max) && ...
        (imgO(290,276,R) >= red_min && imgO(290,276,R) <= red_max) && ...
        (imgO(289,276,R) >= red_min && imgO(289,276,R) <= red_max) && ...
        (imgO(288,276,R) >= red_min && imgO(288,276,R) <= red_max) && ...
        (imgO(287,276,R) >= red_min && imgO(287,276,R) <= red_max) && ...
        (imgO(286,276,R) >= red_min && imgO(286,276,R) <= red_max) && ...
        (imgO(285,277,R) >= red_min && imgO(285,277,R) <= red_max) && ...
        (imgO(284,277,R) >= red_min && imgO(284,277,R) <= red_max) && ...
        (imgO(283,277,R) >= red_min && imgO(283,277,R) <= red_max) && ...
        (imgO(282,277,R) >= red_min && imgO(282,277,R) <= red_max) && ...
        (imgO(281,278,R) >= red_min && imgO(281,278,R) <= red_max) )

        %segura botao
        holding_buttons('red') = true;
        holding_times('red') = tic;
        
        fprintf(galileo,'%c', APERTA_SEM_SOLTAR_RED);  
    end

    %quando o rastro acaba solta
    %Se esta_apertando e nao ha mais rastro passando
    if( holding_buttons('red') && ...
        ~(imgO(311,274,R) >= red_min && imgO(311,274,R) <= red_max) && ...
        toc(holding_times('red')) > 0.35)

        holding_buttons('red') = false;

        fprintf(galileo,'%c', SOLTA_RED);  

    end


    %Green
    %Segura botao no rastro
    %Se nao esta apertando e passa o rastro pela primeira vez
    if( ~holding_buttons('green') && ...
        (imgO(293,238,G) >= green_min && imgO(293,238,G) <= green_max) && ...
        (imgO(292,238,G) >= green_min && imgO(292,238,G) <= green_max) && ...
        (imgO(291,239,G) >= green_min && imgO(291,239,G) <= green_max) && ...
        (imgO(290,239,G) >= green_min && imgO(290,239,G) <= green_max) && ...
        (imgO(289,239,G) >= green_min && imgO(289,239,G) <= green_max) && ...
        (imgO(288,240,G) >= green_min && imgO(288,240,G) <= green_max) && ...
        (imgO(287,240,G) >= green_min && imgO(287,240,G) <= green_max) && ...
        (imgO(286,240,G) >= green_min && imgO(286,240,G) <= green_max) && ...
        (imgO(285,241,G) >= green_min && imgO(285,241,G) <= green_max) && ...
        (imgO(284,241,G) >= green_min && imgO(284,241,G) <= green_max) && ...
        (imgO(283,241,G) >= green_min && imgO(283,241,G) <= green_max) && ...
        (imgO(282,242,G) >= green_min && imgO(282,242,G) <= green_max) && ...
        (imgO(281,243,G) >= green_min && imgO(281,243,G) <= green_max) )

        %segura botao
        holding_buttons('green') = true;
        holding_times('green') = tic;
        
        fprintf(galileo,'%c', APERTA_SEM_SOLTAR_GREEN);  
    end

    %quando o rastro acaba solta
    %Se esta_apertando e nao ha mais rastro passando
    if( holding_buttons('green') && ...
        ~(imgO(312,230,G) >= green_min && imgO(312,230,G) <= green_max) && ...
        toc(holding_times('green')) > 0.35)

        holding_buttons('green') = false;

        fprintf(galileo,'%c', SOLTA_GREEN);  

    end

    %Yellow
    %Segura botao no rastro
    %Se nao esta apertando e passa o rastro pela primeira vez
    if( ~holding_buttons('yellow') && ...
        (imgO(293,312,R) >= yellowR_min && imgO(293,312,R) <= yellowR_max) && ...
        (imgO(293,312,G) >= yellowG_min && imgO(293,312,G) <= yellowG_max) && ...
        (imgO(292,312,R) >= yellowR_min && imgO(292,312,R) <= yellowR_max) && ...
        (imgO(292,312,G) >= yellowG_min && imgO(292,312,G) <= yellowG_max) && ...
        (imgO(291,312,R) >= yellowR_min && imgO(291,312,R) <= yellowR_max) && ...
        (imgO(291,312,G) >= yellowG_min && imgO(291,312,G) <= yellowG_max) && ...
        (imgO(290,312,R) >= yellowR_min && imgO(290,312,R) <= yellowR_max) && ...
        (imgO(290,312,G) >= yellowG_min && imgO(290,312,G) <= yellowG_max) && ...
        (imgO(289,312,R) >= yellowR_min && imgO(289,312,R) <= yellowR_max) && ...
        (imgO(289,312,G) >= yellowG_min && imgO(289,312,G) <= yellowG_max) && ...
        (imgO(288,312,R) >= yellowR_min && imgO(288,312,R) <= yellowR_max) && ...
        (imgO(288,312,G) >= yellowG_min && imgO(288,312,G) <= yellowG_max) && ...
        (imgO(287,312,R) >= yellowR_min && imgO(287,312,R) <= yellowR_max) && ...
        (imgO(287,312,G) >= yellowG_min && imgO(287,312,G) <= yellowG_max) && ...
        (imgO(286,312,R) >= yellowR_min && imgO(286,312,R) <= yellowR_max) && ...
        (imgO(286,312,G) >= yellowG_min && imgO(286,312,G) <= yellowG_max) && ...
        (imgO(285,312,R) >= yellowR_min && imgO(285,312,R) <= yellowR_max) && ...
        (imgO(285,312,G) >= yellowG_min && imgO(285,312,G) <= yellowG_max) && ...
        (imgO(284,312,R) >= yellowR_min && imgO(284,312,R) <= yellowR_max) && ...
        (imgO(284,312,G) >= yellowG_min && imgO(284,312,G) <= yellowG_max) && ...
        (imgO(283,312,R) >= yellowR_min && imgO(283,312,R) <= yellowR_max) && ...
        (imgO(283,312,G) >= yellowG_min && imgO(283,312,G) <= yellowG_max) && ...
        (imgO(282,312,R) >= yellowR_min && imgO(282,312,R) <= yellowR_max) && ...
        (imgO(282,312,G) >= yellowG_min && imgO(282,312,G) <= yellowG_max) && ...
        (imgO(281,312,R) >= yellowR_min && imgO(281,312,R) <= yellowR_max) && ...
        (imgO(281,312,G) >= yellowG_min && imgO(281,312,G) <= yellowG_max) )
        
        %segura botao
        holding_buttons('yellow') = true;
        holding_times('yellow') = tic;
        
        fprintf(galileo,'%c', APERTA_SEM_SOLTAR_YELLOW);  
    end

    %quando o rastro acaba solta
    %Se esta_apertando e nao ha mais rastro passando
    if( holding_buttons('yellow') && ...
        ~(imgO(312,311,R) >= yellowR_min && imgO(312,311,R) <= yellowR_max && ...
          imgO(312,311,G) >= yellowG_min && imgO(312,311,G) <= yellowG_max) && ...
        toc(holding_times('yellow')) > 0.35)

        holding_buttons('yellow') = false;

        fprintf(galileo,'%c', SOLTA_YELLOW);  

    end

    %Blue
    %Segura botao no rastro
    %Se nao esta apertando e passa o rastro pela primeira vez
    if( ~holding_buttons('blue') && ...
        (imgO(291,349,B) >= blueB_min && imgO(291,349,B) <= BlueB_max) && ...
        (imgO(291,349,G) >= blueG_min && imgO(291,349,G) <= BlueG_max) && ...
        (imgO(290,349,B) >= blueB_min && imgO(290,349,B) <= BlueB_max) && ...
        (imgO(290,349,G) >= blueG_min && imgO(290,349,G) <= BlueG_max) && ...
        (imgO(289,349,B) >= blueB_min && imgO(289,349,B) <= BlueB_max) && ...
        (imgO(289,349,G) >= blueG_min && imgO(289,349,G) <= BlueG_max) && ...
        (imgO(288,349,B) >= blueB_min && imgO(288,349,B) <= BlueB_max) && ...
        (imgO(288,349,G) >= blueG_min && imgO(288,349,G) <= BlueG_max) && ...
        (imgO(287,349,B) >= blueB_min && imgO(287,349,B) <= BlueB_max) && ...
        (imgO(287,349,G) >= blueG_min && imgO(287,349,G) <= BlueG_max) && ...
        (imgO(286,349,B) >= blueB_min && imgO(286,349,B) <= BlueB_max) && ...
        (imgO(286,349,G) >= blueG_min && imgO(286,349,G) <= BlueG_max) && ...
        (imgO(285,348,B) >= blueB_min && imgO(285,348,B) <= BlueB_max) && ...
        (imgO(285,348,G) >= blueG_min && imgO(285,348,G) <= BlueG_max) && ...
        (imgO(284,348,B) >= blueB_min && imgO(284,348,B) <= BlueB_max) && ...
        (imgO(284,348,G) >= blueG_min && imgO(284,348,G) <= BlueG_max) && ...
        (imgO(283,348,B) >= blueB_min && imgO(283,348,B) <= BlueB_max) && ...
        (imgO(283,348,G) >= blueG_min && imgO(283,348,G) <= BlueG_max) && ...
        (imgO(282,348,B) >= blueB_min && imgO(282,348,B) <= BlueB_max) && ...
        (imgO(282,348,G) >= blueG_min && imgO(282,348,G) <= BlueG_max) && ...
        (imgO(281,348,B) >= blueB_min && imgO(281,348,B) <= BlueB_max) && ...
        (imgO(281,348,G) >= blueG_min && imgO(281,348,G) <= BlueG_max) && ...
        (imgO(280,348,B) >= blueB_min && imgO(280,348,B) <= BlueB_max) && ...
        (imgO(280,348,G) >= blueG_min && imgO(280,348,G) <= BlueG_max) && ...
        (imgO(279,348,B) >= blueB_min && imgO(279,348,B) <= BlueB_max) && ...
        (imgO(279,348,G) >= blueG_min && imgO(279,348,G) <= BlueG_max) )
        
        %segura botao
        holding_buttons('blue') = true;
        holding_times('blue') = tic;
        
        fprintf(galileo,'%c', APERTA_SEM_SOLTAR_BLUE);  
    end

    %quando o rastro acaba solta
    %Se esta_apertando e nao ha mais rastro passando
    if( holding_buttons('blue') && ...
        ~(imgO(312,311,B) >= blueB_min && imgO(312,311,B) <= BlueB_max && ...
          imgO(312,311,G) >= blueG_min && imgO(312,311,G) <= BlueG_max) && ...
        toc(holding_times('blue')) > 0.35)

        holding_buttons('blue') = false;

        fprintf(galileo,'%c', SOLTA_BLUE);  

    end

    %Orange
    %Segura botao no rastro
    %Se nao esta apertando e passa o rastro pela primeira vez
    if( ~holding_buttons('orange') && ...
        (imgO(294,387,R) >= orangeR_min && imgO(294,387,G) <= orangeR_max) && ...
        (imgO(294,387,G) >= orangeG_min && imgO(294,387,G) <= orangeG_max) && ...
        (imgO(293,387,R) >= orangeR_min && imgO(293,387,R) <= orangeR_max) && ...
        (imgO(293,387,G) >= orangeG_min && imgO(293,387,G) <= orangeG_max) && ...
        (imgO(292,386,R) >= orangeR_min && imgO(292,386,R) <= orangeR_max) && ...
        (imgO(292,386,G) >= orangeG_min && imgO(292,386,G) <= orangeG_max) && ...
        (imgO(291,386,R) >= orangeR_min && imgO(291,386,R) <= orangeR_max) && ...
        (imgO(291,386,G) >= orangeG_min && imgO(291,386,G) <= orangeG_max) && ...
        (imgO(290,386,R) >= orangeR_min && imgO(290,386,R) <= orangeR_max) && ...
        (imgO(290,386,G) >= orangeG_min && imgO(290,386,G) <= orangeG_max) && ...
        (imgO(289,385,R) >= orangeR_min && imgO(289,385,R) <= orangeR_max) && ...
        (imgO(289,385,G) >= orangeG_min && imgO(289,385,G) <= orangeG_max) && ...
        (imgO(288,385,R) >= orangeR_min && imgO(288,385,R) <= orangeR_max) && ...
        (imgO(288,385,G) >= orangeG_min && imgO(288,385,G) <= orangeG_max) && ...
        (imgO(287,385,R) >= orangeR_min && imgO(287,385,R) <= orangeR_max) && ...
        (imgO(287,385,G) >= orangeG_min && imgO(287,385,G) <= orangeG_max) && ...
        (imgO(286,384,R) >= orangeR_min && imgO(286,384,R) <= orangeR_max) && ...
        (imgO(286,384,G) >= orangeG_min && imgO(286,384,G) <= orangeG_max) && ...
        (imgO(285,384,R) >= orangeR_min && imgO(285,384,R) <= orangeR_max) && ...
        (imgO(285,384,G) >= orangeG_min && imgO(285,384,G) <= orangeG_max) && ...
        (imgO(284,384,R) >= orangeR_min && imgO(284,384,R) <= orangeR_max) && ...
        (imgO(284,384,G) >= orangeG_min && imgO(284,384,G) <= orangeG_max) && ...
        (imgO(283,383,R) >= orangeR_min && imgO(283,383,R) <= orangeR_max) && ...
        (imgO(283,383,G) >= orangeG_min && imgO(283,383,G) <= orangeG_max) && ...
        (imgO(282,382,R) >= orangeR_min && imgO(282,382,R) <= orangeR_max) && ...
        (imgO(282,382,G) >= orangeG_min && imgO(282,382,G) <= orangeG_max) )
        
        %segura botao
        holding_buttons('orange') = true;
        holding_times('orange') = tic;
        
        fprintf(galileo,'%c', APERTA_SEM_SOLTAR_ORANGE);  
    end

    %quando o rastro acaba solta
    %Se esta_apertando e nao ha mais rastro passando
    if( holding_buttons('orange') && ...
        ~(imgO(312,311,R) >= orangeR_min && imgO(312,311,R) <= orangeR_max && ...
          imgO(312,311,G) >= orangeG_min && imgO(312,311,G) <= orangeG_max) && ...
        toc(holding_times('orange')) > 0.35)

        holding_buttons('orange') = false;

        fprintf(galileo,'%c', SOLTA_ORANGE);  

    end

end